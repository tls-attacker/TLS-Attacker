Test a MITM workflow trace

# Given this config:
<config>
    <defaultRunningMode>MITM</defaultRunningMode>
</config>

# And this input trace
<workflowTrace>
    <InboundConnection>
        <alias>server</alias>
        <port>443</port>
    </InboundConnection>
    <OutboundConnection>
        <alias>client</alias>
        <port>443</port>
        <hostname>localhost</hostname>
    </OutboundConnection>
    <Receive>
        <connectionAlias>server</connectionAlias>
        <expectedMessages>
            <ClientHello/>
        </expectedMessages>
    </Receive>
    <Send>
        <connectionAlias>server</connectionAlias>
        <configuredMessages>
            <ServerHello/>
            <Certificate/>
            <ServerHelloDone/>
        </configuredMessages>
    </Send>
    <Receive>
        <connectionAlias>server</connectionAlias>
        <expectedMessages>
            <RSAClientKeyExchange/>
            <ChangeCipherSpec/>
            <Finished/>
        </expectedMessages>
    </Receive>
    <Send>
        <connectionAlias>server</connectionAlias>
        <configuredMessages>
            <ChangeCipherSpec/>
            <Finished/>
        </configuredMessages>
    </Send>
    <Send>
        <connectionAlias>client</connectionAlias>
        <configuredMessages>
            <ClientHello/>
        </configuredMessages>
    </Send>
    <Receive>
        <connectionAlias>client</connectionAlias>
        <expectedMessages>
            <ServerHello/>
            <Certificate/>
            <ServerHelloDone/>
        </expectedMessages>
    </Receive>
    <Send>
        <connectionAlias>client</connectionAlias>
        <configuredMessages>
            <RSAClientKeyExchange/>
            <ChangeCipherSpec/>
            <Finished/>
        </configuredMessages>
    </Send>
    <Receive>
        <connectionAlias>client</connectionAlias>
        <expectedMessages>
            <ChangeCipherSpec/>
            <Finished/>
        </expectedMessages>
    </Receive>
    <PrintLastHandledApplicationData>
        <connectionAlias>server</connectionAlias>
        <stringEncoding>US-ASCII</stringEncoding>
    </PrintLastHandledApplicationData>
</workflowTrace>


# We expect this normalized trace
<workflowTrace>
    <InboundConnection>
        <alias>server</alias>
        <ip>localhost</ip>
        <port>443</port>
        <hostname>localhost</hostname>
        <timeout>1000</timeout>
        <firstTimeout>1000</firstTimeout>
        <connectionTimeout>8000</connectionTimeout>
        <transportHandlerType>TCP</transportHandlerType>
        <useIpv6>false</useIpv6>
    </InboundConnection>
    <OutboundConnection>
        <alias>client</alias>
        <ip>localhost</ip>
        <port>443</port>
        <hostname>localhost</hostname>
        <timeout>1000</timeout>
        <firstTimeout>1000</firstTimeout>
        <connectionTimeout>8000</connectionTimeout>
        <transportHandlerType>TCP</transportHandlerType>
        <useIpv6>false</useIpv6>
    </OutboundConnection>
    <Receive>
        <connectionAlias>server</connectionAlias>
        <expectedMessages>
            <ClientHello/>
        </expectedMessages>
    </Receive>
    <Send>
        <connectionAlias>server</connectionAlias>
        <configuredMessages>
            <ServerHello>
                <autoSetHelloRetryModeInKeyShare>true</autoSetHelloRetryModeInKeyShare>
            </ServerHello>
            <Certificate/>
            <ServerHelloDone/>
        </configuredMessages>
    </Send>
    <Receive>
        <connectionAlias>server</connectionAlias>
        <expectedMessages>
            <RSAClientKeyExchange/>
            <ChangeCipherSpec/>
            <Finished/>
        </expectedMessages>
    </Receive>
    <Send>
        <connectionAlias>server</connectionAlias>
        <configuredMessages>
            <ChangeCipherSpec/>
            <Finished/>
        </configuredMessages>
    </Send>
    <Send>
        <connectionAlias>client</connectionAlias>
        <configuredMessages>
            <ClientHello/>
        </configuredMessages>
    </Send>
    <Receive>
        <connectionAlias>client</connectionAlias>
        <expectedMessages>
            <ServerHello>
                <autoSetHelloRetryModeInKeyShare>true</autoSetHelloRetryModeInKeyShare>
            </ServerHello>
            <Certificate/>
            <ServerHelloDone/>
        </expectedMessages>
    </Receive>
    <Send>
        <connectionAlias>client</connectionAlias>
        <configuredMessages>
            <RSAClientKeyExchange/>
            <ChangeCipherSpec/>
            <Finished/>
        </configuredMessages>
    </Send>
    <Receive>
        <connectionAlias>client</connectionAlias>
        <expectedMessages>
            <ChangeCipherSpec/>
            <Finished/>
        </expectedMessages>
    </Receive>
    <PrintLastHandledApplicationData>
        <connectionAlias>server</connectionAlias>
        <stringEncoding>US-ASCII</stringEncoding>
    </PrintLastHandledApplicationData>
</workflowTrace>


# And this after default filter application:
<workflowTrace>
    <InboundConnection>
        <alias>server</alias>
        <port>443</port>
    </InboundConnection>
    <OutboundConnection>
        <alias>client</alias>
        <port>443</port>
        <hostname>localhost</hostname>
    </OutboundConnection>
    <Receive>
        <connectionAlias>server</connectionAlias>
        <expectedMessages>
            <ClientHello/>
        </expectedMessages>
    </Receive>
    <Send>
        <connectionAlias>server</connectionAlias>
        <configuredMessages>
            <ServerHello>
                <autoSetHelloRetryModeInKeyShare>true</autoSetHelloRetryModeInKeyShare>
            </ServerHello>
            <Certificate/>
            <ServerHelloDone/>
        </configuredMessages>
    </Send>
    <Receive>
        <connectionAlias>server</connectionAlias>
        <expectedMessages>
            <RSAClientKeyExchange/>
            <ChangeCipherSpec/>
            <Finished/>
        </expectedMessages>
    </Receive>
    <Send>
        <connectionAlias>server</connectionAlias>
        <configuredMessages>
            <ChangeCipherSpec/>
            <Finished/>
        </configuredMessages>
    </Send>
    <Send>
        <connectionAlias>client</connectionAlias>
        <configuredMessages>
            <ClientHello/>
        </configuredMessages>
    </Send>
    <Receive>
        <connectionAlias>client</connectionAlias>
        <expectedMessages>
            <ServerHello>
                <autoSetHelloRetryModeInKeyShare>true</autoSetHelloRetryModeInKeyShare>
            </ServerHello>
            <Certificate/>
            <ServerHelloDone/>
        </expectedMessages>
    </Receive>
    <Send>
        <connectionAlias>client</connectionAlias>
        <configuredMessages>
            <RSAClientKeyExchange/>
            <ChangeCipherSpec/>
            <Finished/>
        </configuredMessages>
    </Send>
    <Receive>
        <connectionAlias>client</connectionAlias>
        <expectedMessages>
            <ChangeCipherSpec/>
            <Finished/>
        </expectedMessages>
    </Receive>
    <PrintLastHandledApplicationData>
        <connectionAlias>server</connectionAlias>
        <stringEncoding>US-ASCII</stringEncoding>
    </PrintLastHandledApplicationData>
</workflowTrace>
